@startuml
!theme plain
skinparam {
    backgroundColor white
    participant {
        backgroundColor #f8f9fa
        borderColor #dee2e6
        fontColor #495057
    }
    sequence {
        arrowColor #6c757d
        lifeLineBackgroundColor #ffffff
        lifeLineBorderColor #dee2e6
        groupBackgroundColor #f1f3f4
        groupBorderColor #dadce0
    }
    note {
        backgroundColor #fff3cd
        borderColor #ffeaa7
        fontColor #856404
    }
}

participant "SnIfxAdapter\n(Initiator)" as I #e3f2fd
participant "SnModel\n(Target)" as T #f3e5f5


== Forward Path Credit ==
I <-- T : **nb_transport_bw**(Phase(transport_type=CREDIT, credits=<credits>)) : ACCEPTED
note right
  This transaction will contain credit information for either
  CHI_REQ or CHI_DATA in the forward path
end note

== Forward Path Transactions ==
group CHI REQ Transaction
    alt Accepted
        I -> T : **nb_transport_fw**(Phase(transport_type=TRANSACTION)) : ACCEPTED
    else Retry
        I -> T : **nb_transport_fw**(Phase(transport_type=TRANSACTION)) : RETRY
        note right
          For any given request, the initiator must always retry.
          The initiator may or may not retry the transaction
          right away.

          E.g. The initiator still attempts to send a request
          w/o enough credit (can be used mainly for debugging)
        end note
    end
end

group CHI WDAT Transaction
    alt Accepted
        I -> T : **nb_transport_fw**(Phase(transport_type=TRANSACTION)) : ACCEPTED
    else Retry
        I -> T : **nb_transport_fw**(Phase(transport_type=TRANSACTION)) : RETRY
        note right
          For any given data, the initiator must always retry.
          The initiator may or may not retry the transaction
          right away.

          E.g. The initiator still attempts to send a request
          w/o enough credit (can be used mainly for debugging)
        end note
    end
end

== Backward Path Credit ==
I --> T : **nb_transport_fw**(Phase(transport_type=CREDIT, credits=<credits>)) : ACCEPTED
note right
  This transaction will contain credit information for either
  CHI_RSP or CHI_DATA in the backward path
end note

== Backward Path Transactions ==
group CHI CRSP Transaction
    alt Accepted
        I <- T : **nb_transport_bw**(Phase(transport_type=TRANSACTION)) : ACCEPTED
    else Retry
        I <- T : **nb_transport_bw**(Phase(transport_type=TRANSACTION)) : RETRY
        note right
          For any given response, the target must always retry.
          The target may or may not retry the transaction
          right away.

          E.g. The target still attempts to send a request
          w/o enough credit (can be used mainly for debugging)
        end note
    end
end

group CHI RDAT Transaction
    alt Accepted
        I <- T : **nb_transport_bw**(Phase(transport_type=TRANSACTION)) : ACCEPTED
    else Retry
        I <- T : **nb_transport_bw**(Phase(transport_type=TRANSACTION)) : RETRY
        note right
          For any given data, the target must always retry.
          The target may or may not retry the transaction
          right away.

          E.g. The target still attempts to send a request
          w/o enough credit (can be used mainly for debugging)
        end note
    end
end

@enduml
